<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SHOP | CART</title>
    {% load django_bootstrap5 %}
    {% bootstrap_css %}
    {% bootstrap_javascript %}
    {% load static %}
    <link rel="stylesheet" href="{% static 'css/style.css' %}">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">

    <style>
        body {
            margin: 0;
            padding: 0;
            background-color: #f8f9fa;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
        }

        th,
        td {
            padding: 12px;
            text-align: center;
        }

        th {
            background-color: #343a40;
            color: white;
        }

        tr:nth-child(even) {
            background-color: #f2f2f2;
        }

        .cart-img {
            width: 75px;
            height: 75px;
            object-fit: cover;
            border-radius: 5px;
        }

        .btn-remove {
            transition: 0.3s;
        }

        .btn-remove:hover {
            transform: scale(1.1);
        }

        @media (max-width: 768px) {
            table,
            thead,
            tbody,
            th,
            td,
            tr {
                display: block;
            }

            tr {
                margin-bottom: 15px;
                border: 1px solid #ddd;
                border-radius: 8px;
                padding: 10px;
                background-color: white;
            }

            th {
                display: none;
            }

            td {
                display: flex;
                justify-content: space-between;
                padding: 8px;
                border: none;
                text-align: left;
            }

            td::before {
                content: attr(data-label);
                font-weight: bold;
            }

            .cart-img {
                width: 60px;
                height: 60px;
            }
        }
    </style>
</head>

<body>

    <!-- Navbar -->
    <nav class="navbar navbar-expand-lg navbar-dark bg-dark fixed-top shadow">
        <div class="container">
            <a class="navbar-brand" href="{% url 'index' %}"><i class="fa fa-cart-plus"></i> ShopCart</a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav"
                aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav ms-auto text-center">
                    <li class="nav-item"><a class="nav-link" href="{% url 'index' %}"><i class="fa fa-home"></i> Home</a></li>
                    {% if request.user.is_authenticated %}
                    <li class="nav-item"><a class="nav-link"><i class="fa fa-user"></i> {{request.user}}</a></li>
                    <li class="nav-item"><a class="nav-link" href="{% url 'logout' %}"><i class="fa fa-sign-out"></i> Logout</a></li>
                    {% else %}
                    <li class="nav-item"><a class="nav-link" href="{% url 'login' %}"><i class="fa fa-sign-in"></i> Login</a></li>
                    <li class="nav-item"><a class="nav-link" href="{% url 'register' %}"><i class="fa fa-user"></i> Register</a></li>
                    {% endif %}
                    <li class="nav-item"><a class="nav-link" href="{% url 'collections' %}"><i class="fa fa-cubes"></i> Collections</a></li>
                    <li class="nav-item"><a class="nav-link" href="{% url 'cart' %}"><i class="fa fa-shopping-cart"></i> Cart</a></li>
                    <li class="nav-item"><a class="nav-link" href="{% url 'fav_view_page' %}"><i class="fa fa-heart"></i> Favourites</a></li>
                </ul>
            </div>
        </div>
    </nav>

    <!-- Cart Section -->
    <section class="py-5" style="margin-top:70px;">
        <div class="container">
            <h4 class="mb-4 text-center">Your Cart</h4>
            <div class="table-responsive shadow-sm bg-white p-3 rounded">
                <table class="table align-middle">
                    <thead>
                        <tr>
                            <th>Image</th>
                            <th>Product Name</th>
                            <th>Unit Price</th>
                            <th>Quantity</th>
                            <th>Amount</th>
                            <th>Remove</th>
                        </tr>
                    </thead>
                    <tbody>
                        {% for item in cart %}
                        <tr>
                            <td data-label="Image"><img src="{{item.product.product_image.url}}" class="cart-img" alt="{{item.product.name}}"></td>
                            <td data-label="Product Name">{{item.product.name}}</td>
                            <td data-label="Unit Price">Rs {{item.product.selling_price|stringformat:'d'}}</td>
                            <td data-label="Quantity">{{item.product_qty}}</td>
                            <td data-label="Amount" class="amt">Rs {{item.total_cost|stringformat:'d'}}</td>
                            <td data-label="Remove">
                                <a href="{% url 'remove_cart' item.id %}" onclick="return confirm('Are you sure you want to remove?')" class="btn btn-danger btn-sm btn-remove">
                                    <i class="fa fa-trash"></i>
                                </a>
                            </td>
                        </tr>
                        {% endfor %}
                        <tr>
                            <td colspan="3"></td>
                            <td><b>Total Amount</b></td>
                            <td id="net">Rs 0</td>
                            <td></td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>
    </section>

    <!-- Footer -->
    <footer class="text-white bg-dark mt-5 pt-4 pb-2">
        <div class="container">
            <div class="row text-center text-md-start">
                <div class="col-md-3 mb-4">
                    <h6 class="fw-bold"><i class="fa fa-cart-plus"></i> Shopcart</h6>
                    <p>One stop destination for your family's fashion needs with latest collections from top brands.</p>
                </div>
                <div class="col-md-3 mb-4">
                    <h6 class="fw-bold">Make Money With Us</h6>
                    <p><a href="#" class="text-reset">Sell on Shopcart</a></p>
                    <p><a href="#" class="text-reset">Affiliate Program</a></p>
                    <p><a href="#" class="text-reset">Referral Program</a></p>
                    <p><a href="#" class="text-reset">Partner with us</a></p>
                </div>
                <div class="col-md-3 mb-4">
                    <h6 class="fw-bold">Useful Links</h6>
                    <p><a href="#" class="text-reset">FAQ</a></p>
                    <p><a href="#" class="text-reset">Shipping & Returns</a></p>
                    <p><a href="#" class="text-reset">Privacy Policy</a></p>
                    <p><a href="#" class="text-reset">Terms & Conditions</a></p>
                </div>
                <div class="col-md-3 mb-4">
                    <h6 class="fw-bold">Contact</h6>
                    <p><i class="fa fa-home"></i> Tirupur</p>
                    <p><i class="fa fa-envelope"></i> sasi190404@gmail.com</p>
                    <p><i class="fa fa-phone"></i> +91 9092687022</p>
                </div>
            </div>
            <div class="text-center mt-3">
                &copy; 2025 Shopcart - Sasi Kumar
            </div>
        </div>
    </footer>

    <!-- Total Amount Script -->
    <script>
        const nodes = document.querySelectorAll('.amt');
        const arr = Array.from(nodes);
        const res = arr.reduce((acc, curr) => acc + Number(curr.textContent.replace(/Rs\s*/g, '')), 0);
        document.getElementById("net").innerHTML = "Rs : " + res;
    </script>

</body>

</html>
